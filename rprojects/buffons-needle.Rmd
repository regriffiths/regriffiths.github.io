---
title: "Buffon's Needle"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(global.par = TRUE)
```

```{r, echo=FALSE}
set.seed(314159)
```
[.Rmd file for this article](https://regriffiths.github.io/rprojects/bessels-correction.Rmd)

In 1733 Georges Buffon posed the question[^1]: 

> When dropping a needle of length l on a floor made up of parallel strips of width $w>l$, what is the probability, $p$, that the needle crosses a border between two strips?

The solution was eventually found to be $$p=\frac{2l}{\pi w},$$ which can be rearranged to get $$\pi=\frac{2l}{pw}.$$ This means that if we can estimate $p$, by dropping many needles on a floor with parallel lines on it and finding the proportion that cross a line (this works because we can view the needle drops as realisations of independent $X\sim\text{Bernoulli}(p)$ random variables and use the law of large numbers to say that the proportion converges almost surely to $\mathbb{E}(X)=p$), we are able to estimate $π$! Let's try with $5000$ needles.

```{r, fig.height=6, fig.width=9}
n <- 5000
pi_estimates <- rep(NA,n)
count <- 0
length <- 0.1
par(mar=c(1,1,1,1))
plot(NULL, ylim=c(0,1), xlim=c(0,1), ylab="", xlab="", yaxt="n", xaxt="n")
for (i in 0:5){abline(h=i/5, lwd=3)}
for (i in 1:n){
  coord_1 <- c(runif(1),runif(1)) # get a random coordinate
  theta <- pi*runif(1,min=0,max=2) # get a random angle
  coord_2 <- c(coord_1[1]+length*cos(theta),coord_1[2]+length*sin(theta)) # use to make a second coordinate
  x_coord <- c(coord_1[1], coord_2[1])
  y_coord <- c(coord_1[2], coord_2[2])
  if (i <= 1000) { # only plot the first 1000 needles to avoid overcrowding the plot
    lines(x_coord,y_coord, col="#00bafc", lwd=2) 
  } 
  sorted <- sort(y_coord) # makes it easier to check if the needle crosses a line
  for (j in 0:5){ # check for each line whether the needle crosses
    if (sorted[1]<=j/5 && sorted[2]>j/5) {
        count <- count + 1
        next # if it crosses one line it won't cross the others so we don't need to check
    }
  }
  if (count > 0) {
    pi_estimates[i] <- (2*length*i)/(0.2*count) # update pi_estimates with current estimate
  } else { # in case no needles have crossed a line yet
    pi_estimates[i] <- NA
  }
}
```

```{r, fig.height=6, fig.width=9}
par(mar = c(5,2,1,2))
plot(1:n,pi_estimates, col="#00bafc", type="l", lwd=2,xlab="Needles Dropped") # plot estimates against number of needles dropped
abline(h=pi, col="#00ac72", lwd=2)
legend("topright", legend=c(expression(pi), "Estimate"), col=c("#00ac72", "#00bafc"),lwd=c(2,2))
```

Pretty good! This method for estimating $\pi$ was an early example of a Monte Carlo method, a powerful type of tool for solving mathematical problems using random sampling.

[^1]: Eric W. Weisstein. Buffon’s Needle Problem. 2021. URL: https://mathworld.wolfram.com/BuffonsNeedleProblem.html (visited on Oct. 2, 2022).↩︎